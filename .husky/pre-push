echo "🔍 Executando auditoria de segurança."
pnpm audit --audit-level=high

if [ $? -ne 0 ]; then
  echo "❌ Vulnerabilidades de segurança encontradas! Corrija-as antes de fazer push."
  exit 1
fi

echo "✅ Nenhuma vulnerabilidade alta/crítica encontrada. Prosseguindo com o push."

echo "Executando testes automatizados e verificando cobertura mínima de 80%..."
pnpm test:coverage
